{"ast":null,"code":"\"use strict\";\n/**\r\n * Copyright (c) \"Neo4j\"\r\n * Neo4j Sweden AB [http://neo4j.com]\r\n *\r\n * This file is part of Neo4j.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar neo4j_driver_core_1 = require(\"neo4j-driver-core\");\n\nvar _a = neo4j_driver_core_1.internal.constants,\n    ACCESS_MODE_READ = _a.ACCESS_MODE_READ,\n    FETCH_ALL = _a.FETCH_ALL,\n    assertString = neo4j_driver_core_1.internal.util.assertString;\n/* eslint-disable no-unused-vars */\n// Signature bytes for each request message type\n\nvar INIT = 0x01; // 0000 0001 // INIT <user_agent> <authentication_token>\n\nvar ACK_FAILURE = 0x0e; // 0000 1110 // ACK_FAILURE - unused\n\nvar RESET = 0x0f; // 0000 1111 // RESET\n\nvar RUN = 0x10; // 0001 0000 // RUN <query> <parameters>\n\nvar DISCARD_ALL = 0x2f; // 0010 1111 // DISCARD_ALL - unused\n\nvar PULL_ALL = 0x3f; // 0011 1111 // PULL_ALL\n\nvar HELLO = 0x01; // 0000 0001 // HELLO <metadata>\n\nvar GOODBYE = 0x02; // 0000 0010 // GOODBYE\n\nvar BEGIN = 0x11; // 0001 0001 // BEGIN <metadata>\n\nvar COMMIT = 0x12; // 0001 0010 // COMMIT\n\nvar ROLLBACK = 0x13; // 0001 0011 // ROLLBACK\n\nvar ROUTE = 0x66; // 0110 0110 // ROUTE\n\nvar DISCARD = 0x2f; // 0010 1111 // DISCARD\n\nvar PULL = 0x3f; // 0011 1111 // PULL\n\nvar READ_MODE = 'r';\n/* eslint-enable no-unused-vars */\n\nvar NO_STATEMENT_ID = -1;\n\nvar RequestMessage =\n/** @class */\nfunction () {\n  function RequestMessage(signature, fields, toString) {\n    this.signature = signature;\n    this.fields = fields;\n    this.toString = toString;\n  }\n  /**\r\n   * Create a new INIT message.\r\n   * @param {string} clientName the client name.\r\n   * @param {Object} authToken the authentication token.\r\n   * @return {RequestMessage} new INIT message.\r\n   */\n\n\n  RequestMessage.init = function (clientName, authToken) {\n    return new RequestMessage(INIT, [clientName, authToken], function () {\n      return \"INIT \" + clientName + \" {...}\";\n    });\n  };\n  /**\r\n   * Create a new RUN message.\r\n   * @param {string} query the cypher query.\r\n   * @param {Object} parameters the query parameters.\r\n   * @return {RequestMessage} new RUN message.\r\n   */\n\n\n  RequestMessage.run = function (query, parameters) {\n    return new RequestMessage(RUN, [query, parameters], function () {\n      return \"RUN \" + query + \" \" + neo4j_driver_core_1.json.stringify(parameters);\n    });\n  };\n  /**\r\n   * Get a PULL_ALL message.\r\n   * @return {RequestMessage} the PULL_ALL message.\r\n   */\n\n\n  RequestMessage.pullAll = function () {\n    return PULL_ALL_MESSAGE;\n  };\n  /**\r\n   * Get a RESET message.\r\n   * @return {RequestMessage} the RESET message.\r\n   */\n\n\n  RequestMessage.reset = function () {\n    return RESET_MESSAGE;\n  };\n  /**\r\n   * Create a new HELLO message.\r\n   * @param {string} userAgent the user agent.\r\n   * @param {Object} authToken the authentication token.\r\n   * @param {Object} optional server side routing, set to routing context to turn on server side routing (> 4.1)\r\n   * @return {RequestMessage} new HELLO message.\r\n   */\n\n\n  RequestMessage.hello = function (userAgent, authToken, routing) {\n    if (routing === void 0) {\n      routing = null;\n    }\n\n    var metadata = Object.assign({\n      user_agent: userAgent\n    }, authToken);\n\n    if (routing) {\n      metadata.routing = routing;\n    }\n\n    return new RequestMessage(HELLO, [metadata], function () {\n      return \"HELLO {user_agent: '\" + userAgent + \"', ...}\";\n    });\n  };\n  /**\r\n   * Create a new BEGIN message.\r\n   * @param {Bookmark} bookmark the bookmark.\r\n   * @param {TxConfig} txConfig the configuration.\r\n   * @param {string} database the database name.\r\n   * @param {string} mode the access mode.\r\n   * @param {string} impersonatedUser the impersonated user.\r\n   * @return {RequestMessage} new BEGIN message.\r\n   */\n\n\n  RequestMessage.begin = function (_a) {\n    var _b = _a === void 0 ? {} : _a,\n        bookmark = _b.bookmark,\n        txConfig = _b.txConfig,\n        database = _b.database,\n        mode = _b.mode,\n        impersonatedUser = _b.impersonatedUser;\n\n    var metadata = buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser);\n    return new RequestMessage(BEGIN, [metadata], function () {\n      return \"BEGIN \" + neo4j_driver_core_1.json.stringify(metadata);\n    });\n  };\n  /**\r\n   * Get a COMMIT message.\r\n   * @return {RequestMessage} the COMMIT message.\r\n   */\n\n\n  RequestMessage.commit = function () {\n    return COMMIT_MESSAGE;\n  };\n  /**\r\n   * Get a ROLLBACK message.\r\n   * @return {RequestMessage} the ROLLBACK message.\r\n   */\n\n\n  RequestMessage.rollback = function () {\n    return ROLLBACK_MESSAGE;\n  };\n  /**\r\n   * Create a new RUN message with additional metadata.\r\n   * @param {string} query the cypher query.\r\n   * @param {Object} parameters the query parameters.\r\n   * @param {Bookmark} bookmark the bookmark.\r\n   * @param {TxConfig} txConfig the configuration.\r\n   * @param {string} database the database name.\r\n   * @param {string} mode the access mode.\r\n   * @param {string} impersonatedUser the impersonated user.\r\n   * @return {RequestMessage} new RUN message with additional metadata.\r\n   */\n\n\n  RequestMessage.runWithMetadata = function (query, parameters, _a) {\n    var _b = _a === void 0 ? {} : _a,\n        bookmark = _b.bookmark,\n        txConfig = _b.txConfig,\n        database = _b.database,\n        mode = _b.mode,\n        impersonatedUser = _b.impersonatedUser;\n\n    var metadata = buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser);\n    return new RequestMessage(RUN, [query, parameters, metadata], function () {\n      return \"RUN \" + query + \" \" + neo4j_driver_core_1.json.stringify(parameters) + \" \" + neo4j_driver_core_1.json.stringify(metadata);\n    });\n  };\n  /**\r\n   * Get a GOODBYE message.\r\n   * @return {RequestMessage} the GOODBYE message.\r\n   */\n\n\n  RequestMessage.goodbye = function () {\n    return GOODBYE_MESSAGE;\n  };\n  /**\r\n   * Generates a new PULL message with additional metadata.\r\n   * @param {Integer|number} stmtId\r\n   * @param {Integer|number} n\r\n   * @return {RequestMessage} the PULL message.\r\n   */\n\n\n  RequestMessage.pull = function (_a) {\n    var _b = _a === void 0 ? {} : _a,\n        _c = _b.stmtId,\n        stmtId = _c === void 0 ? NO_STATEMENT_ID : _c,\n        _d = _b.n,\n        n = _d === void 0 ? FETCH_ALL : _d;\n\n    var metadata = buildStreamMetadata(stmtId === null || stmtId === undefined ? NO_STATEMENT_ID : stmtId, n || FETCH_ALL);\n    return new RequestMessage(PULL, [metadata], function () {\n      return \"PULL \" + neo4j_driver_core_1.json.stringify(metadata);\n    });\n  };\n  /**\r\n   * Generates a new DISCARD message with additional metadata.\r\n   * @param {Integer|number} stmtId\r\n   * @param {Integer|number} n\r\n   * @return {RequestMessage} the PULL message.\r\n   */\n\n\n  RequestMessage.discard = function (_a) {\n    var _b = _a === void 0 ? {} : _a,\n        _c = _b.stmtId,\n        stmtId = _c === void 0 ? NO_STATEMENT_ID : _c,\n        _d = _b.n,\n        n = _d === void 0 ? FETCH_ALL : _d;\n\n    var metadata = buildStreamMetadata(stmtId === null || stmtId === undefined ? NO_STATEMENT_ID : stmtId, n || FETCH_ALL);\n    return new RequestMessage(DISCARD, [metadata], function () {\n      return \"DISCARD \" + neo4j_driver_core_1.json.stringify(metadata);\n    });\n  };\n  /**\r\n   * Generate the ROUTE message, this message is used to fetch the routing table from the server\r\n   *\r\n   * @param {object} routingContext The routing context used to define the routing table. Multi-datacenter deployments is one of its use cases\r\n   * @param {string[]} bookmarks The list of the bookmark should be used\r\n   * @param {string} databaseName The name of the database to get the routing table for.\r\n   * @return {RequestMessage} the ROUTE message.\r\n   */\n\n\n  RequestMessage.route = function (routingContext, bookmarks, databaseName) {\n    if (routingContext === void 0) {\n      routingContext = {};\n    }\n\n    if (bookmarks === void 0) {\n      bookmarks = [];\n    }\n\n    if (databaseName === void 0) {\n      databaseName = null;\n    }\n\n    return new RequestMessage(ROUTE, [routingContext, bookmarks, databaseName], function () {\n      return \"ROUTE \" + neo4j_driver_core_1.json.stringify(routingContext) + \" \" + neo4j_driver_core_1.json.stringify(bookmarks) + \" \" + databaseName;\n    });\n  };\n  /**\r\n   * Generate the ROUTE message, this message is used to fetch the routing table from the server\r\n   *\r\n   * @param {object} routingContext The routing context used to define the routing table. Multi-datacenter deployments is one of its use cases\r\n   * @param {string[]} bookmarks The list of the bookmark should be used\r\n   * @param {object} databaseContext The context inforamtion of the database to get the routing table for.\r\n   * @param {string} databaseContext.databaseName The name of the database to get the routing table.\r\n   * @param {string} databaseContext.impersonatedUser The name of the user to impersonation when getting the routing table.\r\n   * @return {RequestMessage} the ROUTE message.\r\n   */\n\n\n  RequestMessage.routeV4x4 = function (routingContext, bookmarks, databaseContext) {\n    if (routingContext === void 0) {\n      routingContext = {};\n    }\n\n    if (bookmarks === void 0) {\n      bookmarks = [];\n    }\n\n    if (databaseContext === void 0) {\n      databaseContext = {};\n    }\n\n    var dbContext = {};\n\n    if (databaseContext.databaseName) {\n      dbContext.db = databaseContext.databaseName;\n    }\n\n    if (databaseContext.impersonatedUser) {\n      dbContext.imp_user = databaseContext.impersonatedUser;\n    }\n\n    return new RequestMessage(ROUTE, [routingContext, bookmarks, dbContext], function () {\n      return \"ROUTE \" + neo4j_driver_core_1.json.stringify(routingContext) + \" \" + neo4j_driver_core_1.json.stringify(bookmarks) + \" \" + neo4j_driver_core_1.json.stringify(dbContext);\n    });\n  };\n\n  return RequestMessage;\n}();\n\nexports.default = RequestMessage;\n/**\r\n * Create an object that represent transaction metadata.\r\n * @param {Bookmark} bookmark the bookmark.\r\n * @param {TxConfig} txConfig the configuration.\r\n * @param {string} database the database name.\r\n * @param {string} mode the access mode.\r\n * @param {string} impersonatedUser the impersonated user mode.\r\n * @return {Object} a metadata object.\r\n */\n\nfunction buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser) {\n  var metadata = {};\n\n  if (!bookmark.isEmpty()) {\n    metadata.bookmarks = bookmark.values();\n  }\n\n  if (txConfig.timeout) {\n    metadata.tx_timeout = txConfig.timeout;\n  }\n\n  if (txConfig.metadata) {\n    metadata.tx_metadata = txConfig.metadata;\n  }\n\n  if (database) {\n    metadata.db = assertString(database, 'database');\n  }\n\n  if (impersonatedUser) {\n    metadata.imp_user = assertString(impersonatedUser, 'impersonatedUser');\n  }\n\n  if (mode === ACCESS_MODE_READ) {\n    metadata.mode = READ_MODE;\n  }\n\n  return metadata;\n}\n/**\r\n * Create an object that represents streaming metadata.\r\n * @param {Integer|number} stmtId The query id to stream its results.\r\n * @param {Integer|number} n The number of records to stream.\r\n * @returns {Object} a metadata object.\r\n */\n\n\nfunction buildStreamMetadata(stmtId, n) {\n  var metadata = {\n    n: (0, neo4j_driver_core_1.int)(n)\n  };\n\n  if (stmtId !== NO_STATEMENT_ID) {\n    metadata.qid = (0, neo4j_driver_core_1.int)(stmtId);\n  }\n\n  return metadata;\n} // constants for messages that never change\n\n\nvar PULL_ALL_MESSAGE = new RequestMessage(PULL_ALL, [], function () {\n  return 'PULL_ALL';\n});\nvar RESET_MESSAGE = new RequestMessage(RESET, [], function () {\n  return 'RESET';\n});\nvar COMMIT_MESSAGE = new RequestMessage(COMMIT, [], function () {\n  return 'COMMIT';\n});\nvar ROLLBACK_MESSAGE = new RequestMessage(ROLLBACK, [], function () {\n  return 'ROLLBACK';\n});\nvar GOODBYE_MESSAGE = new RequestMessage(GOODBYE, [], function () {\n  return 'GOODBYE';\n});","map":{"version":3,"sources":["D:/Documents/EMA/Mines A3/NoSQL/ReseauAchats/reseau_achats/node_modules/neo4j-driver-bolt-connection/lib/bolt/request-message.js"],"names":["Object","defineProperty","exports","value","neo4j_driver_core_1","require","_a","internal","constants","ACCESS_MODE_READ","FETCH_ALL","assertString","util","INIT","ACK_FAILURE","RESET","RUN","DISCARD_ALL","PULL_ALL","HELLO","GOODBYE","BEGIN","COMMIT","ROLLBACK","ROUTE","DISCARD","PULL","READ_MODE","NO_STATEMENT_ID","RequestMessage","signature","fields","toString","init","clientName","authToken","run","query","parameters","json","stringify","pullAll","PULL_ALL_MESSAGE","reset","RESET_MESSAGE","hello","userAgent","routing","metadata","assign","user_agent","begin","_b","bookmark","txConfig","database","mode","impersonatedUser","buildTxMetadata","commit","COMMIT_MESSAGE","rollback","ROLLBACK_MESSAGE","runWithMetadata","goodbye","GOODBYE_MESSAGE","pull","_c","stmtId","_d","n","buildStreamMetadata","undefined","discard","route","routingContext","bookmarks","databaseName","routeV4x4","databaseContext","dbContext","db","imp_user","default","isEmpty","values","timeout","tx_timeout","tx_metadata","int","qid"],"mappings":"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","sourcesContent":["\"use strict\";\r\n/**\r\n * Copyright (c) \"Neo4j\"\r\n * Neo4j Sweden AB [http://neo4j.com]\r\n *\r\n * This file is part of Neo4j.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar neo4j_driver_core_1 = require(\"neo4j-driver-core\");\r\nvar _a = neo4j_driver_core_1.internal.constants, ACCESS_MODE_READ = _a.ACCESS_MODE_READ, FETCH_ALL = _a.FETCH_ALL, assertString = neo4j_driver_core_1.internal.util.assertString;\r\n/* eslint-disable no-unused-vars */\r\n// Signature bytes for each request message type\r\nvar INIT = 0x01; // 0000 0001 // INIT <user_agent> <authentication_token>\r\nvar ACK_FAILURE = 0x0e; // 0000 1110 // ACK_FAILURE - unused\r\nvar RESET = 0x0f; // 0000 1111 // RESET\r\nvar RUN = 0x10; // 0001 0000 // RUN <query> <parameters>\r\nvar DISCARD_ALL = 0x2f; // 0010 1111 // DISCARD_ALL - unused\r\nvar PULL_ALL = 0x3f; // 0011 1111 // PULL_ALL\r\nvar HELLO = 0x01; // 0000 0001 // HELLO <metadata>\r\nvar GOODBYE = 0x02; // 0000 0010 // GOODBYE\r\nvar BEGIN = 0x11; // 0001 0001 // BEGIN <metadata>\r\nvar COMMIT = 0x12; // 0001 0010 // COMMIT\r\nvar ROLLBACK = 0x13; // 0001 0011 // ROLLBACK\r\nvar ROUTE = 0x66; // 0110 0110 // ROUTE\r\nvar DISCARD = 0x2f; // 0010 1111 // DISCARD\r\nvar PULL = 0x3f; // 0011 1111 // PULL\r\nvar READ_MODE = 'r';\r\n/* eslint-enable no-unused-vars */\r\nvar NO_STATEMENT_ID = -1;\r\nvar RequestMessage = /** @class */ (function () {\r\n    function RequestMessage(signature, fields, toString) {\r\n        this.signature = signature;\r\n        this.fields = fields;\r\n        this.toString = toString;\r\n    }\r\n    /**\r\n     * Create a new INIT message.\r\n     * @param {string} clientName the client name.\r\n     * @param {Object} authToken the authentication token.\r\n     * @return {RequestMessage} new INIT message.\r\n     */\r\n    RequestMessage.init = function (clientName, authToken) {\r\n        return new RequestMessage(INIT, [clientName, authToken], function () { return \"INIT \" + clientName + \" {...}\"; });\r\n    };\r\n    /**\r\n     * Create a new RUN message.\r\n     * @param {string} query the cypher query.\r\n     * @param {Object} parameters the query parameters.\r\n     * @return {RequestMessage} new RUN message.\r\n     */\r\n    RequestMessage.run = function (query, parameters) {\r\n        return new RequestMessage(RUN, [query, parameters], function () { return \"RUN \" + query + \" \" + neo4j_driver_core_1.json.stringify(parameters); });\r\n    };\r\n    /**\r\n     * Get a PULL_ALL message.\r\n     * @return {RequestMessage} the PULL_ALL message.\r\n     */\r\n    RequestMessage.pullAll = function () {\r\n        return PULL_ALL_MESSAGE;\r\n    };\r\n    /**\r\n     * Get a RESET message.\r\n     * @return {RequestMessage} the RESET message.\r\n     */\r\n    RequestMessage.reset = function () {\r\n        return RESET_MESSAGE;\r\n    };\r\n    /**\r\n     * Create a new HELLO message.\r\n     * @param {string} userAgent the user agent.\r\n     * @param {Object} authToken the authentication token.\r\n     * @param {Object} optional server side routing, set to routing context to turn on server side routing (> 4.1)\r\n     * @return {RequestMessage} new HELLO message.\r\n     */\r\n    RequestMessage.hello = function (userAgent, authToken, routing) {\r\n        if (routing === void 0) { routing = null; }\r\n        var metadata = Object.assign({ user_agent: userAgent }, authToken);\r\n        if (routing) {\r\n            metadata.routing = routing;\r\n        }\r\n        return new RequestMessage(HELLO, [metadata], function () { return \"HELLO {user_agent: '\" + userAgent + \"', ...}\"; });\r\n    };\r\n    /**\r\n     * Create a new BEGIN message.\r\n     * @param {Bookmark} bookmark the bookmark.\r\n     * @param {TxConfig} txConfig the configuration.\r\n     * @param {string} database the database name.\r\n     * @param {string} mode the access mode.\r\n     * @param {string} impersonatedUser the impersonated user.\r\n     * @return {RequestMessage} new BEGIN message.\r\n     */\r\n    RequestMessage.begin = function (_a) {\r\n        var _b = _a === void 0 ? {} : _a, bookmark = _b.bookmark, txConfig = _b.txConfig, database = _b.database, mode = _b.mode, impersonatedUser = _b.impersonatedUser;\r\n        var metadata = buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser);\r\n        return new RequestMessage(BEGIN, [metadata], function () { return \"BEGIN \" + neo4j_driver_core_1.json.stringify(metadata); });\r\n    };\r\n    /**\r\n     * Get a COMMIT message.\r\n     * @return {RequestMessage} the COMMIT message.\r\n     */\r\n    RequestMessage.commit = function () {\r\n        return COMMIT_MESSAGE;\r\n    };\r\n    /**\r\n     * Get a ROLLBACK message.\r\n     * @return {RequestMessage} the ROLLBACK message.\r\n     */\r\n    RequestMessage.rollback = function () {\r\n        return ROLLBACK_MESSAGE;\r\n    };\r\n    /**\r\n     * Create a new RUN message with additional metadata.\r\n     * @param {string} query the cypher query.\r\n     * @param {Object} parameters the query parameters.\r\n     * @param {Bookmark} bookmark the bookmark.\r\n     * @param {TxConfig} txConfig the configuration.\r\n     * @param {string} database the database name.\r\n     * @param {string} mode the access mode.\r\n     * @param {string} impersonatedUser the impersonated user.\r\n     * @return {RequestMessage} new RUN message with additional metadata.\r\n     */\r\n    RequestMessage.runWithMetadata = function (query, parameters, _a) {\r\n        var _b = _a === void 0 ? {} : _a, bookmark = _b.bookmark, txConfig = _b.txConfig, database = _b.database, mode = _b.mode, impersonatedUser = _b.impersonatedUser;\r\n        var metadata = buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser);\r\n        return new RequestMessage(RUN, [query, parameters, metadata], function () {\r\n            return \"RUN \" + query + \" \" + neo4j_driver_core_1.json.stringify(parameters) + \" \" + neo4j_driver_core_1.json.stringify(metadata);\r\n        });\r\n    };\r\n    /**\r\n     * Get a GOODBYE message.\r\n     * @return {RequestMessage} the GOODBYE message.\r\n     */\r\n    RequestMessage.goodbye = function () {\r\n        return GOODBYE_MESSAGE;\r\n    };\r\n    /**\r\n     * Generates a new PULL message with additional metadata.\r\n     * @param {Integer|number} stmtId\r\n     * @param {Integer|number} n\r\n     * @return {RequestMessage} the PULL message.\r\n     */\r\n    RequestMessage.pull = function (_a) {\r\n        var _b = _a === void 0 ? {} : _a, _c = _b.stmtId, stmtId = _c === void 0 ? NO_STATEMENT_ID : _c, _d = _b.n, n = _d === void 0 ? FETCH_ALL : _d;\r\n        var metadata = buildStreamMetadata(stmtId === null || stmtId === undefined ? NO_STATEMENT_ID : stmtId, n || FETCH_ALL);\r\n        return new RequestMessage(PULL, [metadata], function () { return \"PULL \" + neo4j_driver_core_1.json.stringify(metadata); });\r\n    };\r\n    /**\r\n     * Generates a new DISCARD message with additional metadata.\r\n     * @param {Integer|number} stmtId\r\n     * @param {Integer|number} n\r\n     * @return {RequestMessage} the PULL message.\r\n     */\r\n    RequestMessage.discard = function (_a) {\r\n        var _b = _a === void 0 ? {} : _a, _c = _b.stmtId, stmtId = _c === void 0 ? NO_STATEMENT_ID : _c, _d = _b.n, n = _d === void 0 ? FETCH_ALL : _d;\r\n        var metadata = buildStreamMetadata(stmtId === null || stmtId === undefined ? NO_STATEMENT_ID : stmtId, n || FETCH_ALL);\r\n        return new RequestMessage(DISCARD, [metadata], function () { return \"DISCARD \" + neo4j_driver_core_1.json.stringify(metadata); });\r\n    };\r\n    /**\r\n     * Generate the ROUTE message, this message is used to fetch the routing table from the server\r\n     *\r\n     * @param {object} routingContext The routing context used to define the routing table. Multi-datacenter deployments is one of its use cases\r\n     * @param {string[]} bookmarks The list of the bookmark should be used\r\n     * @param {string} databaseName The name of the database to get the routing table for.\r\n     * @return {RequestMessage} the ROUTE message.\r\n     */\r\n    RequestMessage.route = function (routingContext, bookmarks, databaseName) {\r\n        if (routingContext === void 0) { routingContext = {}; }\r\n        if (bookmarks === void 0) { bookmarks = []; }\r\n        if (databaseName === void 0) { databaseName = null; }\r\n        return new RequestMessage(ROUTE, [routingContext, bookmarks, databaseName], function () {\r\n            return \"ROUTE \" + neo4j_driver_core_1.json.stringify(routingContext) + \" \" + neo4j_driver_core_1.json.stringify(bookmarks) + \" \" + databaseName;\r\n        });\r\n    };\r\n    /**\r\n     * Generate the ROUTE message, this message is used to fetch the routing table from the server\r\n     *\r\n     * @param {object} routingContext The routing context used to define the routing table. Multi-datacenter deployments is one of its use cases\r\n     * @param {string[]} bookmarks The list of the bookmark should be used\r\n     * @param {object} databaseContext The context inforamtion of the database to get the routing table for.\r\n     * @param {string} databaseContext.databaseName The name of the database to get the routing table.\r\n     * @param {string} databaseContext.impersonatedUser The name of the user to impersonation when getting the routing table.\r\n     * @return {RequestMessage} the ROUTE message.\r\n     */\r\n    RequestMessage.routeV4x4 = function (routingContext, bookmarks, databaseContext) {\r\n        if (routingContext === void 0) { routingContext = {}; }\r\n        if (bookmarks === void 0) { bookmarks = []; }\r\n        if (databaseContext === void 0) { databaseContext = {}; }\r\n        var dbContext = {};\r\n        if (databaseContext.databaseName) {\r\n            dbContext.db = databaseContext.databaseName;\r\n        }\r\n        if (databaseContext.impersonatedUser) {\r\n            dbContext.imp_user = databaseContext.impersonatedUser;\r\n        }\r\n        return new RequestMessage(ROUTE, [routingContext, bookmarks, dbContext], function () {\r\n            return \"ROUTE \" + neo4j_driver_core_1.json.stringify(routingContext) + \" \" + neo4j_driver_core_1.json.stringify(bookmarks) + \" \" + neo4j_driver_core_1.json.stringify(dbContext);\r\n        });\r\n    };\r\n    return RequestMessage;\r\n}());\r\nexports.default = RequestMessage;\r\n/**\r\n * Create an object that represent transaction metadata.\r\n * @param {Bookmark} bookmark the bookmark.\r\n * @param {TxConfig} txConfig the configuration.\r\n * @param {string} database the database name.\r\n * @param {string} mode the access mode.\r\n * @param {string} impersonatedUser the impersonated user mode.\r\n * @return {Object} a metadata object.\r\n */\r\nfunction buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser) {\r\n    var metadata = {};\r\n    if (!bookmark.isEmpty()) {\r\n        metadata.bookmarks = bookmark.values();\r\n    }\r\n    if (txConfig.timeout) {\r\n        metadata.tx_timeout = txConfig.timeout;\r\n    }\r\n    if (txConfig.metadata) {\r\n        metadata.tx_metadata = txConfig.metadata;\r\n    }\r\n    if (database) {\r\n        metadata.db = assertString(database, 'database');\r\n    }\r\n    if (impersonatedUser) {\r\n        metadata.imp_user = assertString(impersonatedUser, 'impersonatedUser');\r\n    }\r\n    if (mode === ACCESS_MODE_READ) {\r\n        metadata.mode = READ_MODE;\r\n    }\r\n    return metadata;\r\n}\r\n/**\r\n * Create an object that represents streaming metadata.\r\n * @param {Integer|number} stmtId The query id to stream its results.\r\n * @param {Integer|number} n The number of records to stream.\r\n * @returns {Object} a metadata object.\r\n */\r\nfunction buildStreamMetadata(stmtId, n) {\r\n    var metadata = { n: (0, neo4j_driver_core_1.int)(n) };\r\n    if (stmtId !== NO_STATEMENT_ID) {\r\n        metadata.qid = (0, neo4j_driver_core_1.int)(stmtId);\r\n    }\r\n    return metadata;\r\n}\r\n// constants for messages that never change\r\nvar PULL_ALL_MESSAGE = new RequestMessage(PULL_ALL, [], function () { return 'PULL_ALL'; });\r\nvar RESET_MESSAGE = new RequestMessage(RESET, [], function () { return 'RESET'; });\r\nvar COMMIT_MESSAGE = new RequestMessage(COMMIT, [], function () { return 'COMMIT'; });\r\nvar ROLLBACK_MESSAGE = new RequestMessage(ROLLBACK, [], function () { return 'ROLLBACK'; });\r\nvar GOODBYE_MESSAGE = new RequestMessage(GOODBYE, [], function () { return 'GOODBYE'; });\r\n"]},"metadata":{},"sourceType":"script"}